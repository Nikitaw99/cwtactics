<!DOCTYPE HTML>
<html manifest="/offline.manifest" >
    <head >
      <script src="config.js" type="text/javascript" ></script>

      <!-- EXT LIB -->
      <script  src="../libJs/blackbird.js" type="text/javascript" ></script>
      <link   href="../libJs/blackbird.css"      type="text/css" rel="stylesheet" />

      <script src="../libJs/jquery-min.js" type="text/javascript" ></script>

      <script src="../libJs/graph.js" type="text/javascript" ></script>
      <script src="../libJs/astar.js" type="text/javascript" ></script>

      <script src="../libJs/amanda.js" type="text/javascript" ></script>
      <script src="../libJs/stacktrace.js" type="text/javascript" ></script>
      <script src="../libJs/animFrame.js" type="text/javascript" ></script>
      <script src="../libJs/hammer.js" type="text/javascript" ></script>


      <!-- GAME -->

      <script src="../srcEngine/engineBase.js" type="text/javascript" ></script>
      <script src="../srcEngine/signals.js" type="text/javascript" ></script>
      <script src="../srcEngine/persistence.js" type="text/javascript" ></script>
      <script src="../srcEngine/utils.js" type="text/javascript" ></script>
      <script src="../srcEngine/map.js" type="text/javascript" ></script>
      <script src="../srcEngine/sheets.js" type="text/javascript" ></script>
      <script src="../srcEngine/turn.js" type="text/javascript" ></script>
      <script src="../srcEngine/move.js" type="text/javascript" ></script>
      <script src="../srcEngine/transport.js" type="text/javascript" ></script>
      <script src="../srcEngine/battle.js" type="text/javascript" ></script>
      <script src="../srcEngine/property.js" type="text/javascript" ></script>
      <script src="../srcEngine/clientAction.js" type="text/javascript" ></script>


      <!-- MOD AND TEST DATA -->

      <script src="../mod/awds.js" type="text/javascript" ></script>
      <script src="../mod/movetypes.js" type="text/javascript" ></script>
      <script src="../mod/scripts.js" type="text/javascript" ></script>
      <script src="../mod/tiles.js" type="text/javascript" ></script>
      <script src="../mod/units.js" type="text/javascript" ></script>
      <script src="../mod/weapons.js" type="text/javascript" ></script>
      <script src="../mod/language.js" type="text/javascript" ></script>

      <script src="../temp/testMap.js" type="text/javascript" ></script>


      <!-- CLIENT -->

      <script src="clientBase.js" type="text/javascript" ></script>
      <script src="images.js" type="text/javascript" ></script>
      <script src="locale.js" type="text/javascript" ></script>
      <script src="screen.js" type="text/javascript" ></script>
      <script src="controls.js" type="text/javascript" ></script>
      <script src="animation.js" type="text/javascript" ></script>
      <script src="menu.js" type="text/javascript" ></script>
      <script src="touch.js" type="text/javascript" ></script>
      <script src="sound.js" type="text/javascript" ></script>

      <link   href="webClient.css"      type="text/css" rel="stylesheet" />

      <script>

        // OWN LOGGER
        var oldLog = util.logWriter;
        util.logWriter = function( l,m ){
          oldLog( l,m );
          switch( l ){
            case 0: log.info( m ); break;
            case 1: log.warn( m ); break;
            case 2: log.error( m ); break;
            default: log.info( m );
          }
        }

        window.onerror = function( message, url, linenumber ){
          util.logError( "Error:",message,"; from:",url,"; at:",linenumber );
        }
      </script>

      <script>
        function loadingClient(){

          // BLACKBIRD
          log.toggle();

          // CONFIGS
          util.DEBUG = true;
          locale.language = "de";
          images.IMAGE_PATH = "../jsBin/cwtwc_pics/";

          persistence.loadModification( CWT_MOD_DEFAULT );

          // LOADS DIFFERENT COMPONENTS
          util.logInfo("initializing client");
          signal.emit( signal.EVENT_CLIENT_INIT );
        }

        function startClient(){
          var oldTime = new Date().getTime();
          function gameLoop(){
            requestAnimationFrame( gameLoop );

            var now = new Date().getTime();
            var delta = now - oldTime;
            oldTime = now;

            client.update( delta );
          }

          persistence.load( testMap );
          
          sound.loadSound("MENU_OK","../sound/ok.wav");

          util.logInfo("client initialized... starting it");
          signal.emit( signal.EVENT_CLIENT_START );

          // ENTER GAME LOOP
          window.requestAnimationFrame( gameLoop );
        }
      </script>
    </head>

    <body onLoad="loadingClient();">

    <audio id="lashSong" src="Lash.mp3" type="audio/mp3" ></audio>

    <div id="CWTWC_APP">

      <div id="fps" style="position: absolute;" ></div>

      <!-- MAP -->
      <canvas id="CWTWC_CANVAS" class="draw_panel" >
        <div style="color: red;" >
          could not display map container! </div> </canvas>


      <div id="log" ></div>
    </div>

    <!-- MENU -->
    <div id="CWTWC_MENU">
      <ul class="cwtwc_menu">

        <li><button id="menuEntry_0"></button></li>
        <li><button id="menuEntry_1"></button></li>
        <li><button id="menuEntry_2"></button></li>
        <li><button id="menuEntry_3"></button></li>
        <li><button id="menuEntry_4"></button></li>
        <li><button id="menuEntry_5"></button></li>
        <li><button id="menuEntry_6"></button></li>
        <li><button id="menuEntry_7"></button></li>
        <li><button id="menuEntry_8"></button></li>
        <li><button id="menuEntry_9"></button></li>

        <li><button id="menuEntry_CANCEL"></button></li>

      </ul>
    </div>
    </body>
</html>