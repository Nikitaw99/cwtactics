<!DOCTYPE html>

<html>
<head>
  <title>datatypes.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="doc.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">
              
                
                <a class="source" href="ai.html">
                  ai.js
                </a>
              
                
                <a class="source" href="base.html">
                  base.js
                </a>
              
                
                <a class="source" href="commands.html">
                  commands.js
                </a>
              
                
                <a class="source" href="controller.html">
                  controller.js
                </a>
              
                
                <a class="source" href="datatypes.html">
                  datatypes.js
                </a>
              
                
                <a class="source" href="dependencies.html">
                  dependencies.js
                </a>
              
                
                <a class="source" href="flow.html">
                  flow.js
                </a>
              
                
                <a class="source" href="input.html">
                  input.js
                </a>
              
                
                <a class="source" href="language.html">
                  language.js
                </a>
              
                
                <a class="source" href="loading.html">
                  loading.js
                </a>
              
                
                <a class="source" href="logic.html">
                  logic.js
                </a>
              
                
                <a class="source" href="model.html">
                  model.js
                </a>
              
                
                <a class="source" href="modification.html">
                  modification.js
                </a>
              
                
                <a class="source" href="renderer.html">
                  renderer.js
                </a>
              
                
                <a class="source" href="test.html">
                  test.js
                </a>
              
            </div>
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>datatypes.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-pi">"use strict"</span>;

<span class="hljs-comment">/**
 * Database for army sheet objects.
 *
 * @type {cwt.SheetDatabase}
 */</span>
cwt.ArmySheet = <span class="hljs-keyword">new</span> cwt.SheetDatabase({
  schema: {
    type: <span class="hljs-string">'object'</span>,
    required: [<span class="hljs-string">'ID'</span>],
    properties: {
      ID: {
        type: <span class="hljs-string">'string'</span>,
        isID: <span class="hljs-literal">true</span>
      }
    }
  }
});

<span class="hljs-comment">/**
 * Database of co sheet objects.
 */</span>
cwt.CoSheet = <span class="hljs-keyword">new</span> cwt.SheetDatabase({
  schema: {
    type: <span class="hljs-string">'object'</span>,
    required: [<span class="hljs-string">'ID'</span>],
    properties: {
      ID: {
        type: <span class="hljs-string">'string'</span>,
        isID: <span class="hljs-literal">true</span>
      }
    }
  }
});

<span class="hljs-comment">/**
 * Movetype sheet holds the static data of an unit type.
 *
 * @class
 */</span>
cwt.MovetypeSheet = <span class="hljs-keyword">new</span> cwt.SheetDatabase({
  schema: {
    type: <span class="hljs-string">'object'</span>,
    required: [<span class="hljs-string">'ID'</span>,<span class="hljs-string">'costs'</span>],
    properties: {
      ID: {
        type: <span class="hljs-string">'string'</span>,
        isID: <span class="hljs-literal">true</span>
      },
      costs:{
        type: <span class="hljs-string">'object'</span>,
        patternProperties: {
          <span class="hljs-string">'\w+'</span>: {
            type: <span class="hljs-string">'integer'</span>,
            minimum: -<span class="hljs-number">1</span>,
            maximum: <span class="hljs-number">100</span>,
            not: <span class="hljs-number">0</span>
          }
        }
      }
    }
  }
});

<span class="hljs-comment">/**
 * Registers a non movable move type.
 */</span>
cwt.MovetypeSheet.registerSheet({
  <span class="hljs-string">"ID"</span>    : <span class="hljs-string">"NO_MOVE"</span>,
  <span class="hljs-string">"sound"</span> : <span class="hljs-literal">null</span>,
  <span class="hljs-string">"costs"</span> : {
    <span class="hljs-string">"*"</span> : -<span class="hljs-number">1</span>
  }
});

<span class="hljs-comment">/**
 *
 */</span>
cwt.PropertySheet = <span class="hljs-keyword">new</span> cwt.SheetDatabase({
  schema: {
    type: <span class="hljs-string">'object'</span>,
    required: [<span class="hljs-string">'ID'</span>],
    properties: {
      ID: {
        type: <span class="hljs-string">'string'</span>,
        isID: <span class="hljs-literal">true</span>
      },
      defense: {
        type:  <span class="hljs-string">'integer'</span>,
        minimum: <span class="hljs-number">0</span>
      },
      vision: {
        type:  <span class="hljs-string">'integer'</span>,
        minimum: <span class="hljs-number">0</span>
      },
      capturePoints: {
        type:  <span class="hljs-string">'integer'</span>,
        minimum: <span class="hljs-number">1</span>
      },
      blocker: {
        type:  <span class="hljs-string">'boolean'</span>
      }
    }
  }
});

<span class="hljs-comment">/**
 * Invisible property type.
 */</span>
cwt.PropertySheet.registerSheet({
  <span class="hljs-string">"ID"</span>            : <span class="hljs-string">"PROP_INV"</span>,
  <span class="hljs-string">"defense"</span>       : <span class="hljs-number">0</span>,
  <span class="hljs-string">"vision"</span>        : <span class="hljs-number">0</span>,
  <span class="hljs-string">"capturePoints"</span> : <span class="hljs-number">1</span>,
  <span class="hljs-string">"blocker"</span>       : <span class="hljs-literal">true</span>,
  <span class="hljs-string">"assets"</span>        : {}
});

cwt.TileSheet = <span class="hljs-keyword">new</span> cwt.SheetDatabase({
  schema: {
    type: <span class="hljs-string">'object'</span>,
    required: [<span class="hljs-string">'ID'</span>],
    properties: {
      ID: {
        type: <span class="hljs-string">'string'</span>,
        isID: <span class="hljs-literal">true</span>
      }
    }
  }
});

<span class="hljs-comment">/**
 * Unit sheet holds the static data of an unit type.
 *
 */</span>
cwt.UnitSheet = <span class="hljs-keyword">new</span> cwt.SheetDatabase({
  schema: {
    type: <span class="hljs-string">'object'</span>,
    required: [<span class="hljs-string">'ID'</span>],
    properties: {
      ID: {
        type: <span class="hljs-string">'string'</span>,
        isID: <span class="hljs-literal">true</span>
      }
    }
  },

  $afterLoad: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
    <span class="hljs-keyword">var</span> schema = {};
    (cwt.createModuleCaller(<span class="hljs-string">"$defineUnitSchema"</span>))(schema);
    cwt.UnitSheet.schema = schema;
  },

  afterConstruct: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">( sheet )</span> {</span>
    sheet.blocked = <span class="hljs-literal">false</span>;
  },

  <span class="hljs-comment">/**
   * Accepts key,value pairs where the key is a unit sheet id or movetype id or *.
   * The value has to be a positive integer greater than 0.
   *
   * @param key
   * @param value
   * @private
   */</span>
  attackTargetCheck_: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(key, value)</span> {</span>
    <span class="hljs-keyword">if</span> (key === <span class="hljs-string">"*"</span>) <span class="hljs-keyword">return</span>;
    cwt.assert(cwt.UnitSheet.sheets.hasOwnProperty(key));
    cwt.assert(value &gt; <span class="hljs-number">0</span>);
  },

  <span class="hljs-comment">/**
   * Accepts key objects that are unit sheet ids or *.
   *
   * @param key
   * @private
   */</span>
  typeTargetCheck_: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(key)</span> {</span>
    <span class="hljs-keyword">if</span> (key === <span class="hljs-string">"*"</span>) <span class="hljs-keyword">return</span>;
    cwt.assert(cwt.UnitSheet.sheets.hasOwnProperty(key));
  },

  <span class="hljs-comment">/**
   * Accepts key objects that are unit sheet ids or movetype ids or *.
   *
   * @param key
   * @private
   */</span>
  typeOrMovetypeTargetCheck_: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(key)</span> {</span>
    <span class="hljs-keyword">if</span> (key === <span class="hljs-string">"*"</span>) <span class="hljs-keyword">return</span>;
    cwt.assert(cwt.UnitSheet.sheets.hasOwnProperty(key) ||
      cwt.MovetypeSheet.sheets.hasOwnProperty(key));
  },

  check: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">( sheet )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>check_ base aw2</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    cwt.assert(sheet.cost &gt;= -<span class="hljs-number">1</span>);
    cwt.assert(sheet.range &gt;= <span class="hljs-number">0</span> &amp;&amp; sheet.range &lt;= MAX_SELECTION_RANGE);
    cwt.assert(cwt.MovetypeSheet.sheets.hasOwnProperty(sheet.movetype));
    cwt.assert(sheet.vision &gt;= <span class="hljs-number">1</span> &amp;&amp; sheet.vision &lt;= MAX_SELECTION_RANGE);
    cwt.assert(sheet.fuel &gt;= <span class="hljs-number">0</span> &amp;&amp; sheet.fuel &lt; <span class="hljs-number">100</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>check_ capturing</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    cwt.assert(sheet.captures === <span class="hljs-literal">undefined</span> || sheet.captures &gt;= <span class="hljs-number">1</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>check_ drain fuel</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    cwt.assert(sheet.dailyFuelDrain === <span class="hljs-literal">undefined</span> || (
      sheet.dailyFuelDrain &gt;= <span class="hljs-number">1</span> &amp;&amp; sheet.dailyFuelDrain &lt; <span class="hljs-number">100</span>));
    cwt.assert(sheet.dailyFuelDrainHidden === <span class="hljs-literal">undefined</span> || (
      sheet.dailyFuelDrainHidden &gt;= <span class="hljs-number">2</span> &amp;&amp; sheet.dailyFuelDrainHidden &lt; <span class="hljs-number">100</span> ));</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>check_ stealth</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    cwt.assert(sheet.stealth === <span class="hljs-keyword">void</span> <span class="hljs-number">0</span> || sheet.stealth === <span class="hljs-literal">true</span> || sheet.stealth === <span class="hljs-literal">false</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>check_ suicide</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (sheet.suicide) {
      cwt.assert(sheet.suicide.damage &gt;= <span class="hljs-number">1</span> &amp;&amp; sheet.suicide.damage &lt;= <span class="hljs-number">10</span>);
      cwt.assert(sheet.suicide.range &gt;= <span class="hljs-number">1</span> &amp;&amp; sheet.suicide.range &lt;= MAX_SELECTION_RANGE);
      <span class="hljs-keyword">if</span> (sheet.suicide.nodamage) {
        cwt.doListCheck(sheet.suicide.nodamage, sheet.typeTargetCheck_);
      }
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>check_ transport</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (sheet.maxloads !== <span class="hljs-literal">undefined</span> || sheet.canload !== <span class="hljs-literal">undefined</span>) {
      cwt.assert(sheet.maxloads &gt;= <span class="hljs-number">1</span>);
      cwt.doListCheck(sheet.canload, sheet.typeOrMovetypeTargetCheck_);
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>check_ supply</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (sheet.supply !== <span class="hljs-literal">undefined</span>) {
      cwt.doListCheck(sheet.supply, sheet.typeOrMovetypeTargetCheck_);
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>check_ attack</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    cwt.assert(sheet.ammo === <span class="hljs-keyword">void</span> <span class="hljs-number">0</span> || (sheet.ammo &gt;= <span class="hljs-number">0</span> &amp;&amp; sheet.ammo &lt; <span class="hljs-number">100</span>));
    <span class="hljs-keyword">if</span> (sheet.attack) {
      cwt.assert(sheet.attack.minrange === <span class="hljs-literal">undefined</span> || sheet.attack.minrange &gt;= <span class="hljs-number">1</span>);
      cwt.assert(sheet.attack.maxrange === <span class="hljs-literal">undefined</span> || (
        sheet.attack.maxrange &gt;= <span class="hljs-number">2</span> &amp;&amp; sheet.attack.maxrange &gt; sheet.attack.minrange ));

      cwt.assert(sheet.attack.main_wp || sheet.attack.sec_wp);
      <span class="hljs-keyword">if</span> (sheet.attack.main_wp) cwt.doObjectCheck(sheet.attack.main_wp, sheet.attackTargetCheck_);
      <span class="hljs-keyword">if</span> (sheet.attack.sec_wp) cwt.doObjectCheck(sheet.attack.sec_wp, sheet.attackTargetCheck_);
    }
  }
});
cwt.UnitSheet.registerSheet({
  <span class="hljs-string">"ID"</span>       : <span class="hljs-string">"CANNON_UNIT_INV"</span>,
  <span class="hljs-string">"cost"</span>     : <span class="hljs-number">0</span>,
  <span class="hljs-string">"range"</span>    : <span class="hljs-number">0</span>,
  <span class="hljs-string">"movetype"</span> : <span class="hljs-string">"NO_MOVE"</span>,
  <span class="hljs-string">"vision"</span>   : <span class="hljs-number">1</span>,
  <span class="hljs-string">"fuel"</span>     : <span class="hljs-number">0</span>,
  <span class="hljs-string">"ammo"</span>     : <span class="hljs-number">0</span>,
  <span class="hljs-string">"assets"</span>   : {}
});
cwt.UnitSheet.registerSheet({
  <span class="hljs-string">"ID"</span>       : <span class="hljs-string">"LASER_UNIT_INV"</span>,
  <span class="hljs-string">"cost"</span>     : <span class="hljs-number">0</span>,
  <span class="hljs-string">"range"</span>    : <span class="hljs-number">0</span>,
  <span class="hljs-string">"movetype"</span> : <span class="hljs-string">"NO_MOVE"</span>,
  <span class="hljs-string">"vision"</span>   : <span class="hljs-number">1</span>,
  <span class="hljs-string">"fuel"</span>     : <span class="hljs-number">0</span>,
  <span class="hljs-string">"ammo"</span>     : <span class="hljs-number">0</span>,
  <span class="hljs-string">"assets"</span>   : {}
});

<span class="hljs-comment">/**
 * Weather sheet database.
 */</span>
cwt.WeatherSheet = <span class="hljs-keyword">new</span> cwt.SheetDatabase({
  schema: {
    type: <span class="hljs-string">'object'</span>,
    required: [<span class="hljs-string">'ID'</span>],
    properties: {
      ID: {
        type: <span class="hljs-string">'string'</span>,
        isID: <span class="hljs-literal">true</span>
      },
      defaultWeather: {
        type: <span class="hljs-string">'boolean'</span>
      }
    }
  },

  afterCheck: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(sheet)</span> {</span>
    <span class="hljs-keyword">if</span> (sheet.defaultWeather) {
      cwt.WeatherSheet.defaultWeather = sheet;
    }
  }

});

<span class="hljs-comment">/**
 * Holds the default weather type.
 *
 * @type {null}
 */</span>
cwt.WeatherSheet.defaultWeather = <span class="hljs-literal">null</span>;</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>