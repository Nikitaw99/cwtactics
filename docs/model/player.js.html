<!DOCTYPE html>
<html>
<head>
  <title>player.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../doc-style.css" />
  <script src="../doc-filelist.js"></script>
  <script>
    var relativeDir = "../", thisFile = "Users/tapsi/Desktop/Dropbox/Dropbox/Dropsi Ordner/Custom Wars Tactics/cwt/srcEngine/model/player.js", defaultSidebar = true;
  </script>
  <script src="../doc-script.js"></script>
</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">
    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container"><div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
      <tr>
        <td class="docs">
          <h1>player.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1">&#182;</a>
</div>
<div class="dox">
  <div class="summary">
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Type</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Number
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre><span class="nx">model</span><span class="p">.</span><span class="nx">MODE_SAME_OBJECT</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2">&#182;</a>
</div>
<div class="dox">
  <div class="summary">
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Type</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Number
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">model</span><span class="p">.</span><span class="nx">MODE_NONE</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3">&#182;</a>
</div>
<div class="dox">
  <div class="summary">
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Type</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Number
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">model</span><span class="p">.</span><span class="nx">MODE_OWN</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4">&#182;</a>
</div>
<div class="dox">
  <div class="summary">
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Type</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Number
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">model</span><span class="p">.</span><span class="nx">MODE_ALLIED</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5">&#182;</a>
</div>
<div class="dox">
  <div class="summary">
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Type</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Number
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">model</span><span class="p">.</span><span class="nx">MODE_TEAM</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6">&#182;</a>
</div>
<div class="dox">
  <div class="summary">
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Type</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Number
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">model</span><span class="p">.</span><span class="nx">MODE_ENEMY</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p>List that contains all player instances. An inactive player is marked 
with {@link CWT_INACTIVE_ID} as team number.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">model</span><span class="p">.</span><span class="nx">players</span> <span class="o">=</span> <span class="nx">util</span><span class="p">.</span><span class="nx">list</span><span class="p">(</span> <span class="nx">CWT_MAX_PLAYER</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">index</span> <span class="p">){</span>
  <span class="k">return</span> <span class="p">{</span>
    

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8">&#182;</a>
</div>
<p>BASE DATA</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">gold</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="nx">team</span><span class="o">:</span> <span class="nx">CWT_INACTIVE_ID</span><span class="p">,</span>
    <span class="nx">name</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
    

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9">&#182;</a>
</div>
<p>CO DATA</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">mainCo</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="nx">sideCo</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="nx">power</span><span class="o">:</span> <span class="nx">model</span><span class="p">.</span><span class="nx">INACTIVE_POWER</span><span class="p">,</span>
    <span class="nx">timesPowerUsed</span><span class="o">:</span> <span class="mi">0</span>
  <span class="p">};</span>
<span class="p">});</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p>Extracts the identical number from an player object.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">player
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">model</span><span class="p">.</span><span class="nx">extractPlayerId</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">player</span> <span class="p">){</span>
  <span class="k">if</span><span class="p">(</span> <span class="nx">player</span> <span class="o">===</span> <span class="kc">null</span> <span class="p">){</span>
    <span class="nx">util</span><span class="p">.</span><span class="nx">raiseError</span><span class="p">(</span><span class="s2">&quot;player argument cannot be null&quot;</span><span class="p">);</span>
  <span class="p">}</span>
  
  <span class="kd">var</span> <span class="nx">players</span> <span class="o">=</span> <span class="nx">model</span><span class="p">.</span><span class="nx">players</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span> <span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">e</span><span class="o">=</span><span class="nx">players</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">e</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">){</span>
    <span class="k">if</span><span class="p">(</span> <span class="nx">players</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">===</span> <span class="nx">player</span> <span class="p">)</span> <span class="k">return</span> <span class="nx">i</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="nx">util</span><span class="p">.</span><span class="nx">raiseError</span><span class="p">(</span> <span class="s2">&quot;cannot find player&quot;</span><span class="p">,</span> <span class="nx">players</span> <span class="p">);</span>
<span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-11" id="section-11">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p>A player has loosed the game round due a specific reason. This function removes all of his units and properties. 
Furthermore the left teams will be checked. If only one team is left then the end game event will be invoked.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">pid</span>
      <span class="dox_type">Number</span>
      <span>id of the player</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">model</span><span class="p">.</span><span class="nx">playerLooses</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">pid</span> <span class="p">){</span>
  <span class="k">if</span><span class="p">(</span> <span class="nx">DEBUG</span> <span class="p">)</span> <span class="nx">util</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="s2">&quot;player&quot;</span><span class="p">,</span><span class="nx">pid</span><span class="p">,</span><span class="s2">&quot;looses this game round&quot;</span><span class="p">);</span>
  

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-12" id="section-12">&#182;</a>
</div>
<p>REMOVE ALL UNITS</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="k">for</span><span class="p">(</span> <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="nx">pid</span><span class="o">*</span><span class="nx">CWT_MAX_UNITS_PER_PLAYER</span><span class="p">,</span> <span class="nx">e</span> <span class="o">=</span> <span class="nx">i</span><span class="o">+</span><span class="nx">CWT_MAX_UNITS_PER_PLAYER</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">e</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">){</span>
    <span class="k">if</span><span class="p">(</span> <span class="nx">model</span><span class="p">.</span><span class="nx">units</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">owner</span> <span class="o">!==</span> <span class="nx">CWT_INACTIVE_ID</span> <span class="p">)</span> <span class="nx">model</span><span class="p">.</span><span class="nx">destroyUnit</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
  <span class="p">}</span>
  

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-13" id="section-13">&#182;</a>
</div>
<p>REMOVE ALL PROPERTIES</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="k">for</span><span class="p">(</span> <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">e</span> <span class="o">=</span> <span class="nx">model</span><span class="p">.</span><span class="nx">properties</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">e</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">){</span>
    <span class="kd">var</span> <span class="nx">prop</span> <span class="o">=</span> <span class="nx">model</span><span class="p">.</span><span class="nx">properties</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
    <span class="k">if</span><span class="p">(</span> <span class="nx">prop</span><span class="p">.</span><span class="nx">owner</span> <span class="o">===</span> <span class="nx">pid</span> <span class="p">){</span>
      <span class="nx">prop</span><span class="p">.</span><span class="nx">owner</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
      

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-14" id="section-14">&#182;</a>
</div>
<p>SPECIALLY FOR BUILDNGS LIKE THE HQ</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
      <span class="kd">var</span> <span class="nx">changeType</span> <span class="o">=</span> <span class="nx">prop</span><span class="p">.</span><span class="nx">type</span><span class="p">.</span><span class="nx">changeAfterCaptured</span><span class="p">;</span>
      <span class="k">if</span><span class="p">(</span> <span class="nx">changeType</span> <span class="p">){</span>
        <span class="nx">prop</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="nx">model</span><span class="p">.</span><span class="nx">tileTypes</span><span class="p">[</span><span class="nx">changeType</span><span class="p">];</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
  
  <span class="nx">model</span><span class="p">.</span><span class="nx">players</span><span class="p">[</span><span class="nx">pid</span><span class="p">].</span><span class="nx">team</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-15" id="section-15">&#182;</a>
</div>
<p>CHECK LEFT TEAMS</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="kd">var</span> <span class="nx">_teamFound</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span> <span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">e</span><span class="o">=</span><span class="nx">model</span><span class="p">.</span><span class="nx">players</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">e</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">){</span>
    <span class="kd">var</span> <span class="nx">player</span> <span class="o">=</span> <span class="nx">model</span><span class="p">.</span><span class="nx">players</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
    <span class="k">if</span><span class="p">(</span> <span class="nx">player</span><span class="p">.</span><span class="nx">team</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span> <span class="p">){</span>
      

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-16" id="section-16">&#182;</a>
</div>
<p>FOUND AN ALIVE PLAYER</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
      <span class="k">if</span><span class="p">(</span> <span class="nx">_teamFound</span> <span class="o">===</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span> <span class="nx">_teamFound</span> <span class="o">=</span> <span class="nx">player</span><span class="p">.</span><span class="nx">team</span><span class="p">;</span>
      <span class="k">else</span> <span class="k">if</span><span class="p">(</span> <span class="nx">_teamFound</span> <span class="o">!==</span> <span class="nx">player</span><span class="p">.</span><span class="nx">team</span> <span class="p">){</span>
        <span class="nx">_teamFound</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="p">}</span>
        <span class="p">}</span>
  <span class="p">}</span>
  

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-17" id="section-17">&#182;</a>
</div>
<p>NO OPPOSITE TEAMS LEFT ?</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="k">if</span><span class="p">(</span> <span class="nx">_teamFound</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span> <span class="nx">model</span><span class="p">.</span><span class="nx">noTeamLeft</span><span class="p">.</span><span class="nx">callAsCommand</span><span class="p">();</span>
<span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-18" id="section-18">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p>Returns true if there is an unit with a given relationship on a tile at a given position (x,y).</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">x</span>
      <span class="dox_type">Number</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">y</span>
      <span class="dox_type">Number</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">pid</span>
      <span class="dox_type">Number</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">mode</span>
      <span class="dox_type">model.MODE_OWN</span>
      <span class="dox_type">model.MODE_ALLIED</span>
      <span class="dox_type">model.MODE_ENEMY</span>
      <span class="dox_type">model.MODE_TEAM</span>
      <span>check mode</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">model</span><span class="p">.</span><span class="nx">thereIsUnitCheck</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">x</span><span class="p">,</span><span class="nx">y</span><span class="p">,</span><span class="nx">pid</span><span class="p">,</span><span class="nx">mode</span> <span class="p">){</span>
  <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="nx">model</span><span class="p">.</span><span class="nx">isValidPosition</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span><span class="nx">y</span><span class="p">)</span> <span class="p">)</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">unit</span> <span class="o">=</span> <span class="nx">model</span><span class="p">.</span><span class="nx">unitPosMap</span><span class="p">[</span><span class="nx">x</span><span class="p">][</span><span class="nx">y</span><span class="p">];</span>
  <span class="k">return</span> <span class="nx">unit</span> <span class="o">!==</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="nx">model</span><span class="p">.</span><span class="nx">relationShipCheck</span><span class="p">(</span><span class="nx">pid</span><span class="p">,</span><span class="nx">unit</span><span class="p">.</span><span class="nx">owner</span><span class="p">)</span> <span class="o">===</span> <span class="nx">mode</span><span class="p">;</span>
<span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-19" id="section-19">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p>Returns true if there is an unit with a given relationship on a tile at a given position (x,y).</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">x</span>
      <span class="dox_type">Number</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">y</span>
      <span class="dox_type">Number</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">pid</span>
      <span class="dox_type">Number</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">mode</span>
      <span class="dox_type">model.MODE_OWN</span>
      <span class="dox_type">model.MODE_ALLIED</span>
      <span class="dox_type">model.MODE_ENEMY</span>
      <span class="dox_type">model.MODE_TEAM</span>
      <span>check mode</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">model</span><span class="p">.</span><span class="nx">thereIsPropertyCheck</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">x</span><span class="p">,</span><span class="nx">y</span><span class="p">,</span><span class="nx">pid</span><span class="p">,</span><span class="nx">mode</span> <span class="p">){</span>
  <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="nx">model</span><span class="p">.</span><span class="nx">isValidPosition</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span><span class="nx">y</span><span class="p">)</span> <span class="p">)</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">property</span> <span class="o">=</span> <span class="nx">model</span><span class="p">.</span><span class="nx">propertyPosMap</span><span class="p">[</span><span class="nx">x</span><span class="p">][</span><span class="nx">y</span><span class="p">];</span>
  <span class="k">return</span> <span class="nx">property</span> <span class="o">!==</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="nx">model</span><span class="p">.</span><span class="nx">relationShipCheck</span><span class="p">(</span><span class="nx">pid</span><span class="p">,</span><span class="nx">property</span><span class="p">.</span><span class="nx">owner</span><span class="p">)</span> <span class="o">===</span> <span class="nx">mode</span><span class="p">;</span>
<span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-20" id="section-20">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p>Returns true if there is an unit with a given relationship on a tile at a given position (x,y).</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">pidA</span>
      <span class="dox_type">Number</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">pidB</span>
      <span class="dox_type">Number</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">mode</span>
      <span class="dox_type">model.MODE_NONE</span>
      <span class="dox_type">model.MODE_OWN</span>
      <span class="dox_type">model.MODE_ALLIED</span>
      <span class="dox_type">model.MODE_ENEMY</span>
      <span>check mode</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">model</span><span class="p">.</span><span class="nx">relationShipCheck</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">pidA</span><span class="p">,</span> <span class="nx">pidB</span> <span class="p">){</span>
  

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-21" id="section-21">&#182;</a>
</div>
<p>NONE</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="k">if</span><span class="p">(</span> <span class="nx">pidA</span> <span class="o">===</span> <span class="kc">null</span> <span class="o">||</span> <span class="nx">pidB</span> <span class="o">===</span> <span class="kc">null</span> <span class="p">)</span> <span class="k">return</span> <span class="nx">model</span><span class="p">.</span><span class="nx">MODE_NONE</span><span class="p">;</span>
  <span class="k">if</span><span class="p">(</span> <span class="nx">pidA</span> <span class="o">===</span> <span class="o">-</span><span class="mi">1</span>   <span class="o">||</span> <span class="nx">pidB</span> <span class="o">===</span> <span class="o">-</span><span class="mi">1</span>   <span class="p">)</span> <span class="k">return</span> <span class="nx">model</span><span class="p">.</span><span class="nx">MODE_NONE</span><span class="p">;</span>
  <span class="k">if</span><span class="p">(</span> <span class="nx">model</span><span class="p">.</span><span class="nx">players</span><span class="p">[</span><span class="nx">pidA</span><span class="p">].</span><span class="nx">team</span> <span class="o">===</span> <span class="o">-</span><span class="mi">1</span> <span class="o">||</span> <span class="nx">model</span><span class="p">.</span><span class="nx">players</span><span class="p">[</span><span class="nx">pidB</span><span class="p">].</span><span class="nx">team</span> <span class="o">===</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span> <span class="k">return</span> <span class="nx">model</span><span class="p">.</span><span class="nx">MODE_NONE</span><span class="p">;</span>
  

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-22" id="section-22">&#182;</a>
</div>
<p>OWN</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="k">if</span><span class="p">(</span> <span class="nx">pidA</span> <span class="o">===</span> <span class="nx">pidB</span> <span class="p">)</span> <span class="k">return</span> <span class="nx">model</span><span class="p">.</span><span class="nx">MODE_OWN</span><span class="p">;</span>
  
  <span class="kd">var</span> <span class="nx">teamA</span> <span class="o">=</span> <span class="nx">model</span><span class="p">.</span><span class="nx">players</span><span class="p">[</span><span class="nx">pidA</span><span class="p">].</span><span class="nx">team</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">teamB</span> <span class="o">=</span> <span class="nx">model</span><span class="p">.</span><span class="nx">players</span><span class="p">[</span><span class="nx">pidB</span><span class="p">].</span><span class="nx">team</span><span class="p">;</span>
  <span class="k">if</span><span class="p">(</span> <span class="nx">teamA</span> <span class="o">===</span> <span class="o">-</span><span class="mi">1</span> <span class="o">||</span> <span class="nx">teamB</span> <span class="o">===</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span> <span class="k">return</span> <span class="nx">model</span><span class="p">.</span><span class="nx">MODE_NONE</span><span class="p">;</span>
  

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-23" id="section-23">&#182;</a>
</div>
<p>ALLIED</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="k">if</span><span class="p">(</span> <span class="nx">teamA</span> <span class="o">===</span> <span class="nx">teamB</span> <span class="p">)</span> <span class="k">return</span> <span class="nx">model</span><span class="p">.</span><span class="nx">MODE_ALLIED</span><span class="p">;</span>
  

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-24" id="section-24">&#182;</a>
</div>
<p>ENEMY</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="k">if</span><span class="p">(</span> <span class="nx">teamA</span> <span class="o">!==</span> <span class="nx">teamB</span> <span class="p">)</span> <span class="k">return</span> <span class="nx">model</span><span class="p">.</span><span class="nx">MODE_ENEMY</span><span class="p">;</span>
  
  <span class="k">return</span> <span class="nx">model</span><span class="p">.</span><span class="nx">MODE_NONE</span><span class="p">;</span>
<span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-25" id="section-25">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p>Returns true if there is an unit with a given relationship in one of the neighbour tiles at a given position (x,y).</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">pid</span>
      <span class="dox_type">Number</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">x</span>
      <span class="dox_type">Number</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">y</span>
      <span class="dox_type">Number</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">mode</span>
      <span class="dox_type">model.MODE_OWN</span>
      <span class="dox_type">model.MODE_ALLIED</span>
      <span class="dox_type">model.MODE_ENEMY</span>
      <span class="dox_type">model.MODE_TEAM</span>
      <span>check mode</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">model</span><span class="p">.</span><span class="nx">relationShipCheckUnitNeighbours</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">pid</span><span class="p">,</span> <span class="nx">x</span><span class="p">,</span><span class="nx">y</span> <span class="p">,</span> <span class="nx">mode</span> <span class="p">){</span>
  <span class="kd">var</span> <span class="nx">check</span> <span class="o">=</span> <span class="nx">model</span><span class="p">.</span><span class="nx">relationShipCheck</span><span class="p">;</span>
  

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-26" id="section-26">&#182;</a>
</div>
<p>LEFT</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="k">if</span><span class="p">(</span> <span class="nx">x</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">model</span><span class="p">.</span><span class="nx">unitPosMap</span><span class="p">[</span><span class="nx">x</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="nx">y</span><span class="p">]</span> <span class="o">!==</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> 
     <span class="nx">check</span><span class="p">(</span> <span class="nx">pid</span><span class="p">,</span> <span class="nx">model</span><span class="p">.</span><span class="nx">unitPosMap</span><span class="p">[</span><span class="nx">x</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="nx">y</span><span class="p">].</span><span class="nx">owner</span> <span class="p">)</span> <span class="o">===</span> <span class="nx">mode</span> <span class="p">)</span> <span class="k">return</span> <span class="kc">true</span><span class="p">;</span> 
  

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-27" id="section-27">&#182;</a>
</div>
<p>UP</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="k">if</span><span class="p">(</span> <span class="nx">y</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">model</span><span class="p">.</span><span class="nx">unitPosMap</span><span class="p">[</span><span class="nx">x</span><span class="p">][</span><span class="nx">y</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!==</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> 
     <span class="nx">check</span><span class="p">(</span> <span class="nx">pid</span><span class="p">,</span> <span class="nx">model</span><span class="p">.</span><span class="nx">unitPosMap</span><span class="p">[</span><span class="nx">x</span><span class="p">][</span><span class="nx">y</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="nx">owner</span> <span class="p">)</span> <span class="o">===</span> <span class="nx">mode</span> <span class="p">)</span> <span class="k">return</span> <span class="kc">true</span><span class="p">;</span> 
  

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-28" id="section-28">&#182;</a>
</div>
<p>RIGHT</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="k">if</span><span class="p">(</span> <span class="nx">x</span> <span class="o">&lt;</span> <span class="nx">model</span><span class="p">.</span><span class="nx">mapWidth</span><span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="nx">model</span><span class="p">.</span><span class="nx">unitPosMap</span><span class="p">[</span><span class="nx">x</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="nx">y</span><span class="p">]</span> <span class="o">!==</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> 
     <span class="nx">check</span><span class="p">(</span> <span class="nx">pid</span><span class="p">,</span> <span class="nx">model</span><span class="p">.</span><span class="nx">unitPosMap</span><span class="p">[</span><span class="nx">x</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="nx">y</span><span class="p">].</span><span class="nx">owner</span> <span class="p">)</span> <span class="o">===</span> <span class="nx">mode</span> <span class="p">)</span> <span class="k">return</span> <span class="kc">true</span><span class="p">;</span> 
  

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-29" id="section-29">&#182;</a>
</div>
<p>DOWN</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="k">if</span><span class="p">(</span> <span class="nx">y</span> <span class="o">&lt;</span> <span class="nx">model</span><span class="p">.</span><span class="nx">mapHeight</span><span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="nx">model</span><span class="p">.</span><span class="nx">unitPosMap</span><span class="p">[</span><span class="nx">x</span><span class="p">][</span><span class="nx">y</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">!==</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> 
     <span class="nx">check</span><span class="p">(</span> <span class="nx">pid</span><span class="p">,</span> <span class="nx">model</span><span class="p">.</span><span class="nx">unitPosMap</span><span class="p">[</span><span class="nx">x</span><span class="p">][</span><span class="nx">y</span><span class="o">+</span><span class="mi">1</span><span class="p">].</span><span class="nx">owner</span> <span class="p">)</span> <span class="o">===</span> <span class="nx">mode</span> <span class="p">)</span> <span class="k">return</span> <span class="kc">true</span><span class="p">;</span> 
  
  <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
<span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-30" id="section-30">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p>Allowed for the client. </p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">model</span><span class="p">.</span><span class="nx">playerGivesUp</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="nx">model</span><span class="p">.</span><span class="nx">playerLooses</span><span class="p">(</span> <span class="nx">model</span><span class="p">.</span><span class="nx">turnOwner</span> <span class="p">);</span>
  <span class="nx">model</span><span class="p">.</span><span class="nx">nextTurn</span><span class="p">();</span>
<span class="p">};</span>

<span class="nx">model</span><span class="p">.</span><span class="nx">noTeamLeft</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="nx">controller</span><span class="p">.</span><span class="nx">endGameRound</span><span class="p">();</span>
<span class="p">};</span>
</pre></div>
        </td>
      </tr>
  </tbody>
</table>
  </div>
</body>
</html>
