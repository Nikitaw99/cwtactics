/**
 * Is the same version of the original one, but with protected scope and clearer public API to prevent 
 * namespace collisions.
 */