{
  "rules":[

    {
      "RULE":"giveLuck",
      "DESC":"gives a bit of luck when a battle happens",
      "ON":"unitAttack",
      "THEN":[
        ["+", "battle.attacker.dmg", ["random", 10]],
        ["+", "battle.defender.dmg", ["random", 10]]
      ]
    },

    {
      "RULE":"loadMap",
      "ON":"loadMap",
      "DESC":"loads the map data into the working memory",
      "THEN":[
      ]
    },

    {"RULE":"initModel",
       "ON":"engineInit",
     "DESC":"initializes the model on game start",
     "THEN":[

       ["set","model.units",
         ["array", ["*","MAX_PLAYER","MAX_UNITS"]]],
       ["forEach","model.units",
         ["copy", ["object",{ "hp":0, "ammo":0, "fuel":0, "exp":0 }]]],

       ["set","model.players",
         ["array", "MAX_PLAYER"]],
       ["forEach","model.players",
         ["copy", ["object",{ "name":"", "gold":0, "fuel":0, "exp":0 }]]],

       ["set","model.map",
         ["object",{
           "day":0,
           "turn":0,
           "weather":null
         }]
       ]
    ]},

    {
      "RULE":"openMapMenu",
      "DESC":"",
      "ON":"userClicked",
      "WHEN":[
        [ "NOT",
          [ "DEF", "click.unit" ] ]
      ],
      "THEN":[
        [ "PUSH", "menu.entrys",
          [ "create.Entry", "INFO", "Information"  ],
          [ "create.Entry", "SETTINGS", "Settings" ],
          [ "create.Entry", "ENDTURN", "End Turn"  ]  ]
      ]
    },

    {"RULE":"openUnitMenu",
     "DESC":"",
     "ON":"userClicked",
     "WHEN":[
       ["exists","click.unit"]
     ],
     "THEN":[
       ["PUSH","menu.entrys",
         ["create.Entry", "ENDTURN",  "Move Unit"]] ]},

    { "RULEGROUP":"debugLog",
      "DESC":"simple rules that logs informations about rule firing",
      "DEACTIVATEABLE":true,
      "RULES":[
        {
          "RULE":"logRuleFired",
          "SYSRULE":true,
          "DESC":"logs an information about a rule firing",
          "ON":"ruleFired",
          "THEN": [
            ["log","info",
              ["format","actions of {0} will be fired","ruleName"]]
          ]
        },
        {
          "RULE":"logRuleCheck",
          "SYSRULE":true,
          "DESC":"logs the start of a check algorithm of a rule",
          "ON":"ruleCheck",
          "THEN":[
            ["log","info",
              ["format","rule {0} will be checked","ruleName"]]
          ]
        },
        {
          "RULE":"logRuleNotFired",
          "SYSRULE":true,
          "DESC":"logs if a rule will not fired",
          "ON":"ruleNotFired",
          "THEN":[
            ["log","info",
              ["format","rule {0} will not be fired","ruleName"]]
          ]
        }
      ]
    }
  ]
}