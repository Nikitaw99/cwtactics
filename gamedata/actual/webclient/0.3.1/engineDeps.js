function Graph(e){for(var t=[],o=0;e.length>o;o++){t[o]=[];for(var n=0,r=e[o];r.length>n;n++)t[o][n]=new GraphNode(o,n,r[n])}this.input=e,this.nodes=t}function GraphNode(e,t,o){this.data={},this.x=e,this.y=t,this.pos={x:e,y:t},this.type=o}function BinaryHeap(e){this.content=[],this.scoreFunction=e}var astar={init:function(e){for(var t=0,o=e.length;o>t;t++)for(var n=0,r=e[t].length;r>n;n++){var l=e[t][n];l.f=0,l.g=0,l.h=0,l.cost=l.type,l.visited=!1,l.closed=!1,l.parent=null}},heap:function(){return new BinaryHeap(function(e){return e.f})},search:function(e,t,o,n,r){astar.init(e),r=r||astar.manhattan,n=!!n;var l=astar.heap();for(l.push(t);l.size()>0;){var a=l.pop();if(a===o){for(var i=a,s=[];i.parent;)s.push(i),i=i.parent;return s.reverse()}a.closed=!0;for(var d=astar.neighbors(e,a,n),u=0,m=d.length;m>u;u++){var c=d[u];if(!c.closed&&!c.isWall()){var p=a.g+c.cost,f=c.visited;(!f||c.g>p)&&(c.visited=!0,c.parent=a,c.h=c.h||r(c.pos,o.pos),c.g=p,c.f=c.g+c.h,f?l.rescoreElement(c):l.push(c))}}}return[]},manhattan:function(e,t){var o=Math.abs(t.x-e.x),n=Math.abs(t.y-e.y);return o+n},neighbors:function(e,t,o){var n=[],r=t.x,l=t.y;return e[r-1]&&e[r-1][l]&&n.push(e[r-1][l]),e[r+1]&&e[r+1][l]&&n.push(e[r+1][l]),e[r]&&e[r][l-1]&&n.push(e[r][l-1]),e[r]&&e[r][l+1]&&n.push(e[r][l+1]),o&&(e[r-1]&&e[r-1][l-1]&&n.push(e[r-1][l-1]),e[r+1]&&e[r+1][l-1]&&n.push(e[r+1][l-1]),e[r-1]&&e[r-1][l+1]&&n.push(e[r-1][l+1]),e[r+1]&&e[r+1][l+1]&&n.push(e[r+1][l+1])),n}},GraphNodeType={OPEN:1,WALL:-1};Graph.prototype.toString=function(){for(var e,t,o,n,r="\n",l=this.nodes,a=0,i=l.length;i>a;a++){for(e="",t=l[a],o=0,n=t.length;n>o;o++)e+=t[o].type+" ";r=r+e+"\n"}return r},GraphNode.prototype.toString=function(){return"["+this.x+" "+this.y+"]"},GraphNode.prototype.isWall=function(){return this.type==GraphNodeType.WALL},BinaryHeap.prototype={push:function(e){this.content.push(e),this.sinkDown(this.content.length-1)},pop:function(){var e=this.content[0],t=this.content.pop();return this.content.length>0&&(this.content[0]=t,this.bubbleUp(0)),e},remove:function(e){var t=this.content.indexOf(e),o=this.content.pop();t!==this.content.length-1&&(this.content[t]=o,this.scoreFunction(o)<this.scoreFunction(e)?this.sinkDown(t):this.bubbleUp(t))},size:function(){return this.content.length},rescoreElement:function(e){this.sinkDown(this.content.indexOf(e))},sinkDown:function(e){for(var t=this.content[e];e>0;){var o=(e+1>>1)-1,n=this.content[o];if(!(this.scoreFunction(t)<this.scoreFunction(n)))break;this.content[o]=t,this.content[e]=n,e=o}},bubbleUp:function(e){for(var t=this.content.length,o=this.content[e],n=this.scoreFunction(o);;){var r=e+1<<1,l=r-1,a=null;if(t>l){var i=this.content[l],s=this.scoreFunction(i);n>s&&(a=l)}if(t>r){var d=this.content[r],u=this.scoreFunction(d);(null===a?n:s)>u&&(a=r)}if(null===a)break;this.content[e]=this.content[a],this.content[a]=o,e=a}}};