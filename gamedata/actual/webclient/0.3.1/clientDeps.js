function getQueryParams(e){e=e.split("+").join(" ");for(var t,n={},o=/[?&]?([^=]+)=([^&]*)/g;t=o.exec(e);)n[decodeURIComponent(t[1])]=decodeURIComponent(t[2]);return n}(function(){for(var e=0,t=["ms","moz","webkit","o"],n=0;t.length>n&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t){var n=(new Date).getTime(),o=Math.max(0,16-(n-e)),r=window.setTimeout(function(){t(n+o)},o);return e=n+o,r}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})})();var Base64Helper={};Base64Helper.canvasToBase64=function(e){var t=document.createElement("canvas");t.width=e.width,t.height=e.height;var n=t.getContext("2d");n.drawImage(e,0,0);var o=t.toDataURL("image/png");return o.replace(/^data:image\/(png|jpg);base64,/,"")},function(e){var t=e;Base64Helper.encodeBuffer=function(e){for(var n,o,r,i,a,l="",s=new Uint8Array(e),c=s.byteLength,u=c%3,d=c-u,m=0;d>m;m+=3)a=s[m]<<16|s[m+1]<<8|s[m+2],n=(16515072&a)>>18,o=(258048&a)>>12,r=(4032&a)>>6,i=63&a,l+=t[n]+t[o]+t[r]+t[i];return 1==u?(a=s[d],n=(252&a)>>2,o=(3&a)<<4,l+=t[n]+t[o]+"=="):2==u&&(a=s[d]<<8|s[d+1],n=(64512&a)>>10,o=(1008&a)>>4,r=(15&a)<<2,l+=t[n]+t[o]+t[r]+"="),l},Base64Helper.decodeBuffer=function(t){var n,o,r,i,a,l=.75*t.length,s=t.length,c=0;"="===t[t.length-1]&&(l--,"="===t[t.length-2]&&l--);var u=new ArrayBuffer(l),d=new Uint8Array(u);for(n=0;s>n;n+=4)o=e.indexOf(t[n]),r=e.indexOf(t[n+1]),i=e.indexOf(t[n+2]),a=e.indexOf(t[n+3]),d[c++]=o<<2|r>>4,d[c++]=(15&r)<<4|i>>2,d[c++]=(3&i)<<6|63&a;return u}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),function(e,t){function n(e){d[d.length]=e}function o(e){u.className=u.className.replace(RegExp("\\b"+e+"\\b"),"")}function r(e,t){for(var n=0,o=e.length;o>n;n++)t.call(e,e[n],n)}function i(){u.className=u.className.replace(/ (w-|eq-|gt-|gte-|lt-|lte-|portrait|no-portrait|landscape|no-landscape)\d+/g,"");var t=e.innerWidth||u.clientWidth,o=e.outerWidth||e.screen.width;p.screen.innerWidth=t,p.screen.outerWidth=o,n("w-"+t),r(m.screens,function(e){t>e?(m.screensCss.gt&&n("gt-"+e),m.screensCss.gte&&n("gte-"+e)):e>t?(m.screensCss.lt&&n("lt-"+e),m.screensCss.lte&&n("lte-"+e)):t===e&&(m.screensCss.lte&&n("lte-"+e),m.screensCss.eq&&n("e-q"+e),m.screensCss.gte&&n("gte-"+e))});var o=e.innerHeight||u.clientHeight,i=e.outerHeight||e.screen.height;p.screen.innerHeight=o,p.screen.outerHeight=i,p.feature("portrait",o>t),p.feature("landscape",t>o)}function a(){e.clearTimeout(g),g=e.setTimeout(i,100)}var l=e.document,s=e.navigator,c=e.location,u=l.documentElement,d=[],m={screens:[240,320,480,640,768,800,1024,1280,1440,1680,1920],screensCss:{gt:!0,gte:!1,lt:!0,lte:!1,eq:!1},browsers:[{ie:{min:6,max:10}}],browserCss:{gt:!0,gte:!1,lt:!0,lte:!1,eq:!0},section:"-section",page:"-page",head:"head"};if(e.head_conf)for(var _ in e.head_conf)e.head_conf[_]!==t&&(m[_]=e.head_conf[_]);var p=e[m.head]=function(){p.ready.apply(null,arguments)};switch(p.feature=function(e,t,r){return e?("[object Function]"===Object.prototype.toString.call(t)&&(t=t.call()),n((t?"":"no-")+e),p[e]=!!t,r||(o("no-"+e),o(e),p.feature()),p):(u.className+=" "+d.join(" "),d=[],p)},p.feature("js",!0),_=s.userAgent.toLowerCase(),s=/mobile|midp/.test(_),p.feature("mobile",s,!0),p.feature("desktop",!s,!0),_=/(chrome|firefox)[ \/]([\w.]+)/.exec(_)||/(iphone|ipad|ipod)(?:.*version)?[ \/]([\w.]+)/.exec(_)||/(android)(?:.*version)?[ \/]([\w.]+)/.exec(_)||/(webkit|opera)(?:.*version)?[ \/]([\w.]+)/.exec(_)||/(msie) ([\w.]+)/.exec(_)||[],s=_[1],_=parseFloat(_[2]),s){case"msie":s="ie",_=l.documentMode||_;break;case"firefox":s="ff";break;case"ipod":case"ipad":case"iphone":s="ios";break;case"webkit":s="safari"}p.browser={name:s,version:_},p.browser[s]=!0;for(var E=0,f=m.browsers.length;f>E;E++)for(var h in m.browsers[E])if(s===h){n(h);for(var I=m.browsers[E][h].max,v=m.browsers[E][h].min;I>=v;v++)_>v?(m.browserCss.gt&&n("gt-"+h+v),m.browserCss.gte&&n("gte-"+h+v)):v>_?(m.browserCss.lt&&n("lt-"+h+v),m.browserCss.lte&&n("lte-"+h+v)):_===v&&(m.browserCss.lte&&n("lte-"+h+v),m.browserCss.eq&&n("eq-"+h+v),m.browserCss.gte&&n("gte-"+h+v))}else n("no-"+h);"ie"===s&&9>_&&r("abbr article aside audio canvas details figcaption figure footer header hgroup mark meter nav output progress section summary time video".split(" "),function(e){l.createElement(e)}),r(c.pathname.split("/"),function(e,o){if(this.length>2&&this[o+1]!==t)o&&n(this.slice(1,o+1).join("-").toLowerCase()+m.section);else{var r=e||"index",i=r.indexOf(".");i>0&&(r=r.substring(0,i)),u.id=r.toLowerCase()+m.page,o||n("root"+m.section)}}),p.screen={height:e.screen.height,width:e.screen.width},i();var g=0;e.addEventListener?e.addEventListener("resize",a,!1):e.attachEvent("onresize",a)}(window);var Lawnchair=function(e,t){if(!(this instanceof Lawnchair))return new Lawnchair(e,t);if(!JSON)throw"JSON unavailable! Include http://www.json.org/json2.js to fix.";if(!(2>=arguments.length&&arguments.length>0))throw"Incorrect # of ctor args!";if(t="function"==typeof arguments[0]?arguments[0]:arguments[1],e="function"==typeof arguments[0]?{}:arguments[0],"function"!=typeof t)throw"No callback was provided";this.record=e.record||"record",this.name=e.name||"records";var n;if(e.adapter){for(var o=0,r=Lawnchair.adapters.length;r>o;o++)if(Lawnchair.adapters[o].adapter===e.adapter){n=Lawnchair.adapters[o].valid()?Lawnchair.adapters[o]:void 0;break}}else for(var o=0,r=Lawnchair.adapters.length;r>o&&!(n=Lawnchair.adapters[o].valid()?Lawnchair.adapters[o]:void 0);o++);if(!n)throw"No valid adapter.";for(var i in n)this[i]=n[i];for(var o=0,r=Lawnchair.plugins.length;r>o;o++)Lawnchair.plugins[o].call(this);this.init(e,t)};Lawnchair.adapters=[],Lawnchair.adapter=function(e,t){t.adapter=e;var n="adapter valid init keys save batch get exists all remove nuke".split(" "),o=this.prototype.indexOf;for(var r in t)if(-1===o(n,r))throw"Invalid adapter! Nonstandard method: "+r;Lawnchair.adapters.splice(0,0,t)},Lawnchair.plugins=[],Lawnchair.plugin=function(e){for(var t in e)"init"===t?Lawnchair.plugins.push(e[t]):this.prototype[t]=e[t]},Lawnchair.prototype={isArray:Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},indexOf:function(e,t,n,o){if(e.indexOf)return e.indexOf(t);for(n=0,o=e.length;o>n;n++)if(e[n]===t)return n;return-1},lambda:function(e){return this.fn(this.record,e)},fn:function(e,t){return"string"==typeof t?Function(e,t):t},uuid:function(){var e=function(){return(0|65536*(1+Math.random())).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},each:function(e){var t=this.lambda(e);if(this.__results)for(var n=0,o=this.__results.length;o>n;n++)t.call(this,this.__results[n],n);else this.all(function(e){for(var n=0,o=e.length;o>n;n++)t.call(this,e[n],n)});return this}},Lawnchair.adapter("dom",function(){var e=window.localStorage,t=function(t){return{key:t+"._index_",all:function(){var t=e.getItem(this.key);return t&&(t=JSON.parse(t)),null===t&&e.setItem(this.key,JSON.stringify([])),JSON.parse(e.getItem(this.key))},add:function(t){var n=this.all();n.push(t),e.setItem(this.key,JSON.stringify(n))},del:function(t){for(var n=this.all(),o=[],r=0,i=n.length;i>r;r++)n[r]!=t&&o.push(n[r]);e.setItem(this.key,JSON.stringify(o))},find:function(e){for(var t=this.all(),n=0,o=t.length;o>n;n++)if(e===t[n])return n;return!1}}};return{valid:function(){return!!e},init:function(e,n){this.indexer=t(this.name),n&&this.fn(this.name,n).call(this,this)},save:function(t,n){var o=t.key?this.name+"."+t.key:this.name+"."+this.uuid();return this.indexer.find(o)===!1&&this.indexer.add(o),delete t.key,e.setItem(o,JSON.stringify(t)),t.key=o.slice(this.name.length+1),n&&this.lambda(n).call(this,t),this},batch:function(e,t){for(var n=[],o=0,r=e.length;r>o;o++)this.save(e[o],function(e){n.push(e)});return t&&this.lambda(t).call(this,n),this},keys:function(e){if(e){var t=this.name,n=this.indexer.all().map(function(e){return e.replace(t+".","")});this.fn("keys",e).call(this,n)}return this},get:function(t,n){if(this.isArray(t)){for(var o=[],r=0,i=t.length;i>r;r++){var a=this.name+"."+t[r],l=e.getItem(a);l&&(l=JSON.parse(l),l.key=t[r],o.push(l))}n&&this.lambda(n).call(this,o)}else{var a=this.name+"."+t,l=e.getItem(a);l&&(l=JSON.parse(l),l.key=t),n&&this.lambda(n).call(this,l)}return this},exists:function(e,t){var n=this.indexer.find(this.name+"."+e)===!1?!1:!0;return this.lambda(t).call(this,n),this},all:function(t){for(var n,o,r=this.indexer.all(),i=[],a=0,l=r.length;l>a;a++)o=r[a],n=JSON.parse(e.getItem(o)),n.key=o.replace(this.name+".",""),i.push(n);return t&&this.fn(this.name,t).call(this,i),this},remove:function(t,n){var o=this.name+"."+(t.key?t.key:t);return this.indexer.del(o),e.removeItem(o),n&&this.lambda(n).call(this),this},nuke:function(e){return this.all(function(t){for(var n=0,o=t.length;o>n;n++)this.remove(t[n]);e&&this.lambda(e).call(this)}),this}}}()),Lawnchair.adapter("window-name",function(e,t){var n=window.top.name?JSON.parse(window.top.name):{};return{valid:function(){return window.top.name!==void 0},init:function(o,r){n[this.name]=n[this.name]||{index:[],store:{}},e=n[this.name].index,t=n[this.name].store,this.fn(this.name,r).call(this,this)},keys:function(t){return this.fn("keys",t).call(this,e),this},save:function(o,r){var i=o.key||this.uuid();return o.key&&delete o.key,this.exists(i,function(a){a||e.push(i),t[i]=o,window.top.name=JSON.stringify(n),o.key=i,r&&this.lambda(r).call(this,o)}),this},batch:function(e,t){for(var n=[],o=0,r=e.length;r>o;o++)this.save(e[o],function(e){n.push(e)});return t&&this.lambda(t).call(this,n),this},get:function(e,n){var o;if(this.isArray(e)){o=[];for(var r=0,i=e.length;i>r;r++)o.push(t[e[r]])}else o=t[e],o&&(o.key=e);return n&&this.lambda(n).call(this,o),this},exists:function(e,n){return this.lambda(n).call(this,!!t[e]),this},all:function(n){for(var o=[],r=0,i=e.length;i>r;r++){var a=t[e[r]];a.key=e[r],o.push(a)}return this.fn(this.name,n).call(this,o),this},remove:function(o,r){for(var i=this.isArray(o)?o:[o],a=0,l=i.length;l>a;a++)delete t[i[a]],e.splice(this.indexOf(e,i[a]),1);return window.top.name=JSON.stringify(n),r&&this.lambda(r).call(this),this},nuke:function(t){return storage={},e=[],window.top.name=JSON.stringify(n),t&&this.lambda(t).call(this),this}}}()),Lawnchair.adapter("indexed-db",function(){function e(e,t){console.log("error in indexed-db adapter!",e,t)}function t(){return window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB||window.oIndexedDB||window.msIndexedDB}return{valid:function(){return!!t()},init:function(n,o){this.idb=t(),this.waiting=[];var r=this.idb.open(this.name),i=this,a=i.fn(i.name,o),l=function(){return a.call(i,i)};r.onsuccess=function(){if(i.db=r.result,"1.0"!=i.db.version){var t=i.db.setVersion("1.0");t.onsuccess=function(){i.store=i.db.createObjectStore("teststore",{autoIncrement:!0});for(var e=0;i.waiting.length>e;e++)i.waiting[e].call(i);i.waiting=[],l()},t.onerror=function(t){console.log("Failed to create objectstore "+t),e(t)}}else{i.store={};for(var n=0;i.waiting.length>n;n++)i.waiting[n].call(i);i.waiting=[],l()}},r.onerror=e},save:function(t,n){if(!this.store)return this.waiting.push(function(){this.save(t,n)}),void 0;var o=this,r=function(e){n&&(t.key=e.target.result,o.lambda(n).call(o,t))},i=this.db.transaction(["teststore"],webkitIDBTransaction.READ_WRITE),a=i.objectStore("teststore"),l=t.key?a.put(t,t.key):a.put(t);return l.onsuccess=r,l.onerror=e,this},batch:function(e,t){for(var n=[],o=!1,r=this,i=function(t){n.push(t),o=n.length===e.length},a=setInterval(function(){o&&(t&&r.lambda(t).call(r,n),clearInterval(a))},200),l=0,s=e.length;s>l;l++)this.save(e[l],i);return this},get:function(t,n){if(!this.store)return this.waiting.push(function(){this.get(t,n)}),void 0;var o=this,r=function(e){n&&o.lambda(n).call(o,e.target.result)};if(this.isArray(t))for(var i=[],a=!1,l=t,s=function(e){i.push(e),a=i.length===l.length},c=setInterval(function(){a&&(n&&o.lambda(n).call(o,i),clearInterval(c))},200),u=0,d=l.length;d>u;u++)this.get(l[u],s);else{var m=this.db.transaction("teststore").objectStore("teststore").get(t);m.onsuccess=r,m.onerror=function(n){console.log("Failed to find "+t),e(n)}}return this},all:function(e){if(!this.store)return this.waiting.push(function(){this.all(e)}),void 0;var t=this.fn(this.name,e)||void 0,n=this,o=this.db.transaction("teststore").objectStore("teststore"),r=[];return o.openCursor().onsuccess=function(e){var o=e.target.result;o?(r.push(o.value),o.continue()):t&&t.call(n,r)},this},remove:function(t,n){if(!this.store)return this.waiting.push(function(){this.remove(t,n)}),void 0;"object"==typeof t&&(t=t.key);var o=this,r=function(){n&&o.lambda(n).call(o)},i=this.db.transaction(["teststore"],webkitIDBTransaction.READ_WRITE).objectStore("teststore").delete(t);return i.onsuccess=r,i.onerror=e,this},nuke:function(t){if(!this.store)return this.waiting.push(function(){this.nuke(t)}),void 0;var n=this,o=t?function(){n.lambda(t).call(n)}:function(){};try{this.db.transaction(["teststore"],webkitIDBTransaction.READ_WRITE).objectStore("teststore").clear().onsuccess=o}catch(r){e()}return this}}}()),Lawnchair.adapter("webkit-sqlite",function(){var e=function(e,t){console.log("error in sqlite adaptor!",e,t)},t=function(){return new Date};return Function.prototype.bind||(Function.prototype.bind=function(e){var t=[].slice,n=t.call(arguments,1),o=this,r=function(){},i=function(){return o.apply(this instanceof r?this:e||{},n.concat(t.call(arguments)))};return r.prototype=o.prototype,i.prototype=new r,i}),{valid:function(){return!!window.openDatabase},init:function(t,n){var o=this,r=o.fn(o.name,n),i="CREATE TABLE IF NOT EXISTS "+this.name+" (id NVARCHAR(32) UNIQUE PRIMARY KEY, value TEXT, timestamp REAL)",a=function(){return r.call(o,o)};this.db=openDatabase(this.name,"1.0.0",this.name,t.maxSize||65536),this.db.transaction(function(t){t.executeSql(i,[],a,e)})},keys:function(t){var n=this.lambda(t),o=this,r="SELECT id FROM "+this.name+" ORDER BY timestamp DESC";return this.db.transaction(function(t){var i=function(e,t){if(0==t.rows.length)n.call(o,[]);else{for(var r=[],i=0,a=t.rows.length;a>i;i++)r.push(t.rows.item(i).id);n.call(o,r)}};t.executeSql(r,[],i,e)}),this},save:function(n,o){var r=this,i=n.key||r.uuid(),a="INSERT INTO "+this.name+" (value, timestamp, id) VALUES (?,?,?)",l="UPDATE "+this.name+" SET value=?, timestamp=? WHERE id=?",s=function(){o&&(n.key=i,r.lambda(o).call(r,n))},c=[t(),i];return r.exists(n.key,function(t){r.db.transaction(function(o){var r=function(t){c.unshift(JSON.stringify(t)),o.executeSql(a,c,s,e)},i=function(t){delete t.key,c.unshift(JSON.stringify(t)),o.executeSql(l,c,s,e)};t?i(n):r(n)})}),this},batch:function(e,t){for(var n=[],o=!1,r=this,i=function(t){n.push(t),o=n.length===e.length},a=setInterval(function(){o&&(t&&r.lambda(t).call(r,n),clearInterval(a))},200),l=0,s=e.length;s>l;l++)this.save(e[l],i);return this},get:function(t,n){var o=this,r="";r=this.isArray(t)?"SELECT id, value FROM "+this.name+" WHERE id IN ('"+t.join("','")+"')":"SELECT id, value FROM "+this.name+" WHERE id = '"+t+"'";var i=function(e,r){var i=null,a=[];if(r.rows.length)for(var l=0,s=r.rows.length;s>l;l++)i=JSON.parse(r.rows.item(l).value),i.key=r.rows.item(l).id,a.push(i);o.isArray(t)||(a=a.length?a[0]:null),n&&o.lambda(n).call(o,a)};return this.db.transaction(function(t){t.executeSql(r,[],i,e)}),this},exists:function(t,n){var o="SELECT * FROM "+this.name+" WHERE id = ?",r=this,i=function(e,t){n&&r.fn("exists",n).call(r,t.rows.length>0)};return this.db.transaction(function(n){n.executeSql(o,[t],i,e)}),this},all:function(t){var n=this,o="SELECT * FROM "+this.name,r=[],i=this.fn(this.name,t)||void 0,a=function(e,t){if(0!=t.rows.length)for(var o=0,a=t.rows.length;a>o;o++){var l=JSON.parse(t.rows.item(o).value);l.key=t.rows.item(o).id,r.push(l)}i&&i.call(n,r)};return this.db.transaction(function(t){t.executeSql(o,[],a,e)}),this},remove:function(t,n){var o=this,r="string"==typeof t?t:t.key,i="DELETE FROM "+this.name+" WHERE id = ?",a=function(){n&&o.lambda(n).call(o)};return this.db.transaction(function(t){t.executeSql(i,[r],a,e)}),this},nuke:function(t){var n="DELETE FROM "+this.name,o=this,r=t?function(){o.lambda(t).call(o)}:function(){};return this.db.transaction(function(t){t.executeSql(n,[],r,e)}),this}}}());var jWorkflow=function(){function e(e){if("function"!=typeof e)throw"expected function but was "+typeof e}function t(e){return"function"==typeof e.andThen&&"function"==typeof e.start&&"function"==typeof e.chill}function n(e){return!!e.map&&!!e.reduce}var o={order:function(o,r){var i,a=[],l=null,s=function(){var e=!1;return{take:function(){e=!0},pass:function(t){var n;e=!1,i.length?(n=i.shift(),t=n.func.apply(n.context,[t,s]),e||s.pass(t)):l.func&&l.func.apply(l.context,[t])},drop:function(t){e=!0,i=[],setTimeout(function(){s.pass(t)},1)}}}(),c={andThen:function(o,r){if(t(o)){var i=function(e,t){t.take(),o.start({callback:function(e){t.pass(e)},context:r,initialValue:e})};a.push({func:i,context:r})}else if(n(o)){var l=function(e,t){t.take();var n=o.length,r=function(){return--n||t.pass()};o.forEach(function(e){jWorkflow.order(e).start(r)})};a.push({func:l,context:r})}else e(o),a.push({func:o,context:r});return c},chill:function(e){return c.andThen(function(t,n){n.take(),setTimeout(function(){n.pass(t)},e)})},start:function(){var e,t,n;arguments[0]&&"object"==typeof arguments[0]?(e=arguments[0].callback,t=arguments[0].context,n=arguments[0].initialValue):(e=arguments[0],t=arguments[1]),l={func:e,context:t},i=a.slice(),s.pass(n)}};return o?c.andThen(o,r):c}};return o}();"object"==typeof module&&"function"==typeof require&&(module.exports=jWorkflow);