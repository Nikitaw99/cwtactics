var jWorkflow=function(){return{order:function(e,t){var o,n=[],r=null,i=function(){var e=!1;return{take:function(){e=!0},pass:function(t){var n;e=!1,o.length?(n=o.shift(),t=n.func.apply(n.context,[t,i]),e||i.pass(t)):r.func&&r.func.apply(r.context,[t])},drop:function(t){e=!0,o=[],setTimeout(function(){i.pass(t)},1)}}}(),l={andThen:function(e,t){if("function"==typeof e.andThen&&"function"==typeof e.start&&"function"==typeof e.chill)n.push({func:function(o,n){n.take(),e.start({callback:function(e){n.pass(e)},context:t,initialValue:o})},context:t});else if(e.map&&e.reduce)n.push({func:function(t,o){o.take();var n=e.length,r=function(){return--n||o.pass()};e.forEach(function(e){jWorkflow.order(e).start(r)})},context:t});else{if("function"!=typeof e)throw"expected function but was "+typeof e;n.push({func:e,context:t})}return l},chill:function(e){return l.andThen(function(t,o){o.take(),setTimeout(function(){o.pass(t)},e)})},start:function(e,t){var l,a,s;e&&"object"==typeof e?(l=e.callback,a=e.context,s=e.initialValue):(l=e,a=t),r={func:l,context:a},o=n.slice(),i.pass(s)}};return e?l.andThen(e,t):l}}}();"object"==typeof module&&"function"==typeof require&&(module.exports=jWorkflow);