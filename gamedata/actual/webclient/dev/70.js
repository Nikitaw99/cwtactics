Lawnchair.adapter("indexed-db",function(){function e(e,t){console.log("error in indexed-db adapter!",e,t)}function t(){return window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB||window.oIndexedDB||window.msIndexedDB}return{valid:function(){return!!t()},init:function(o,n){this.idb=t(),this.waiting=[];var r=this.idb.open(this.name),l=this,i=l.fn(l.name,n),a=function(){return i.call(l,l)};r.onsuccess=function(){if(l.db=r.result,"1.0"!=l.db.version){var t=l.db.setVersion("1.0");t.onsuccess=function(){l.store=l.db.createObjectStore("teststore",{autoIncrement:!0});for(var e=0;l.waiting.length>e;e++)l.waiting[e].call(l);l.waiting=[],a()},t.onerror=function(t){console.log("Failed to create objectstore "+t),e(t)}}else{l.store={};for(var o=0;l.waiting.length>o;o++)l.waiting[o].call(l);l.waiting=[],a()}},r.onerror=e},save:function(t,o){if(!this.store)return this.waiting.push(function(){this.save(t,o)}),void 0;var n=this,r=function(e){o&&(t.key=e.target.result,n.lambda(o).call(n,t))},l=this.db.transaction(["teststore"],webkitIDBTransaction.READ_WRITE),i=l.objectStore("teststore"),a=t.key?i.put(t,t.key):i.put(t);return a.onsuccess=r,a.onerror=e,this},batch:function(e,t){for(var o=[],n=!1,r=this,l=function(t){o.push(t),n=o.length===e.length},i=setInterval(function(){n&&(t&&r.lambda(t).call(r,o),clearInterval(i))},200),a=0,s=e.length;s>a;a++)this.save(e[a],l);return this},get:function(t,o){if(!this.store)return this.waiting.push(function(){this.get(t,o)}),void 0;var n=this,r=function(e){o&&n.lambda(o).call(n,e.target.result)};if(this.isArray(t))for(var l=[],i=!1,a=t,s=function(e){l.push(e),i=l.length===a.length},c=setInterval(function(){i&&(o&&n.lambda(o).call(n,l),clearInterval(c))},200),d=0,u=a.length;u>d;d++)this.get(a[d],s);else{var m=this.db.transaction("teststore").objectStore("teststore").get(t);m.onsuccess=r,m.onerror=function(o){console.log("Failed to find "+t),e(o)}}return this},all:function(e){if(!this.store)return this.waiting.push(function(){this.all(e)}),void 0;var t=this.fn(this.name,e)||void 0,o=this,n=this.db.transaction("teststore").objectStore("teststore"),r=[];return n.openCursor().onsuccess=function(e){var n=e.target.result;n?(r.push(n.value),n.continue()):t&&t.call(o,r)},this},remove:function(t,o){if(!this.store)return this.waiting.push(function(){this.remove(t,o)}),void 0;"object"==typeof t&&(t=t.key);var n=this,r=function(){o&&n.lambda(o).call(n)},l=this.db.transaction(["teststore"],webkitIDBTransaction.READ_WRITE).objectStore("teststore").delete(t);return l.onsuccess=r,l.onerror=e,this},nuke:function(t){if(!this.store)return this.waiting.push(function(){this.nuke(t)}),void 0;var o=this,n=t?function(){o.lambda(t).call(o)}:function(){};try{this.db.transaction(["teststore"],webkitIDBTransaction.READ_WRITE).objectStore("teststore").clear().onsuccess=n}catch(r){e()}return this}}}());