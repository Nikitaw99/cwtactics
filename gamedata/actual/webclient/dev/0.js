function Graph(t){for(var n=[],e=0;t.length>e;e++){n[e]=[];for(var o=0,i=t[e];i.length>o;o++)n[e][o]=new GraphNode(e,o,i[o])}this.input=t,this.nodes=n}function GraphNode(t,n,e){this.data={},this.x=t,this.y=n,this.pos={x:t,y:n},this.type=e}function BinaryHeap(t){this.content=[],this.scoreFunction=t}var GraphNodeType={OPEN:1,WALL:-1};Graph.prototype.toString=function(){for(var t,n,e,o,i="\n",s=this.nodes,r=0,h=s.length;h>r;r++){for(t="",n=s[r],e=0,o=n.length;o>e;e++)t+=n[e].type+" ";i=i+t+"\n"}return i},GraphNode.prototype.toString=function(){return"["+this.x+" "+this.y+"]"},GraphNode.prototype.isWall=function(){return this.type==GraphNodeType.WALL},BinaryHeap.prototype={push:function(t){this.content.push(t),this.sinkDown(this.content.length-1)},pop:function(){var t=this.content[0],n=this.content.pop();return this.content.length>0&&(this.content[0]=n,this.bubbleUp(0)),t},remove:function(t){var n=this.content.indexOf(t),e=this.content.pop();n!==this.content.length-1&&(this.content[n]=e,this.scoreFunction(e)<this.scoreFunction(t)?this.sinkDown(n):this.bubbleUp(n))},size:function(){return this.content.length},rescoreElement:function(t){this.sinkDown(this.content.indexOf(t))},sinkDown:function(t){for(var n=this.content[t];t>0;){var e=(t+1>>1)-1,o=this.content[e];if(!(this.scoreFunction(n)<this.scoreFunction(o)))break;this.content[e]=n,this.content[t]=o,t=e}},bubbleUp:function(t){for(var n=this.content.length,e=this.content[t],o=this.scoreFunction(e);;){var i=t+1<<1,s=i-1,r=null;if(n>s){var h=this.scoreFunction(this.content[s]);o>h&&(r=s)}if(n>i&&(null===r?o:h)>this.scoreFunction(this.content[i])&&(r=i),null===r)break;this.content[t]=this.content[r],this.content[r]=e,t=r}}};var astar={init:function(t){for(var n=0,e=t.length;e>n;n++)for(var o=0,i=t[n].length;i>o;o++){var s=t[n][o];s.f=0,s.g=0,s.h=0,s.cost=s.type,s.visited=!1,s.closed=!1,s.parent=null}},heap:function(){return new BinaryHeap(function(t){return t.f})},search:function(t,n,e,o,i){astar.init(t),i=i||astar.manhattan,o=!!o;var s=astar.heap();for(s.push(n);s.size()>0;){if(n=s.pop(),n===e){for(t=n,e=[];t.parent;)e.push(t),t=t.parent;return e.reverse()}n.closed=!0;for(var r=astar.neighbors(t,n,o),h=0,a=r.length;a>h;h++){var c=r[h];if(!c.closed&&!c.isWall()){var p=n.g+c.cost,u=c.visited;(!u||c.g>p)&&(c.visited=!0,c.parent=n,c.h=c.h||i(c.pos,e.pos),c.g=p,c.f=c.g+c.h,u?s.rescoreElement(c):s.push(c))}}}return[]},manhattan:function(t,n){var e=Math.abs(n.x-t.x),o=Math.abs(n.y-t.y);return e+o},neighbors:function(t,n,e){var o=[],i=n.x;return n=n.y,t[i-1]&&t[i-1][n]&&o.push(t[i-1][n]),t[i+1]&&t[i+1][n]&&o.push(t[i+1][n]),t[i]&&t[i][n-1]&&o.push(t[i][n-1]),t[i]&&t[i][n+1]&&o.push(t[i][n+1]),e&&(t[i-1]&&t[i-1][n-1]&&o.push(t[i-1][n-1]),t[i+1]&&t[i+1][n-1]&&o.push(t[i+1][n-1]),t[i-1]&&t[i-1][n+1]&&o.push(t[i-1][n+1]),t[i+1]&&t[i+1][n+1]&&o.push(t[i+1][n+1])),o}};