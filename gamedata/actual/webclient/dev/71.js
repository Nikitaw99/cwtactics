Lawnchair.adapter("webkit-sqlite",function(){var e=function(e,t){console.log("error in sqlite adaptor!",e,t)},t=function(){return new Date};return Function.prototype.bind||(Function.prototype.bind=function(e){var t=[].slice,o=t.call(arguments,1),n=this,r=function(){},i=function(){return n.apply(this instanceof r?this:e||{},o.concat(t.call(arguments)))};return r.prototype=n.prototype,i.prototype=new r,i}),{valid:function(){return!!window.openDatabase},init:function(t,o){var n=this,r=n.fn(n.name,o),i="CREATE TABLE IF NOT EXISTS "+this.name+" (id NVARCHAR(32) UNIQUE PRIMARY KEY, value TEXT, timestamp REAL)",l=function(){return r.call(n,n)};this.db=openDatabase(this.name,"1.0.0",this.name,t.maxSize||65536),this.db.transaction(function(t){t.executeSql(i,[],l,e)})},keys:function(t){var o=this.lambda(t),n=this,r="SELECT id FROM "+this.name+" ORDER BY timestamp DESC";return this.db.transaction(function(t){var i=function(e,t){if(0==t.rows.length)o.call(n,[]);else{for(var r=[],i=0,l=t.rows.length;l>i;i++)r.push(t.rows.item(i).id);o.call(n,r)}};t.executeSql(r,[],i,e)}),this},save:function(o,n){var r=this,i=o.key||r.uuid(),l="INSERT INTO "+this.name+" (value, timestamp, id) VALUES (?,?,?)",a="UPDATE "+this.name+" SET value=?, timestamp=? WHERE id=?",s=function(){n&&(o.key=i,r.lambda(n).call(r,o))},c=[t(),i];return r.exists(o.key,function(t){r.db.transaction(function(n){var r=function(t){c.unshift(JSON.stringify(t)),n.executeSql(l,c,s,e)},i=function(t){delete t.key,c.unshift(JSON.stringify(t)),n.executeSql(a,c,s,e)};t?i(o):r(o)})}),this},batch:function(e,t){for(var o=[],n=!1,r=this,i=function(t){o.push(t),n=o.length===e.length},l=setInterval(function(){n&&(t&&r.lambda(t).call(r,o),clearInterval(l))},200),a=0,s=e.length;s>a;a++)this.save(e[a],i);return this},get:function(t,o){var n=this,r="";r=this.isArray(t)?"SELECT id, value FROM "+this.name+" WHERE id IN ('"+t.join("','")+"')":"SELECT id, value FROM "+this.name+" WHERE id = '"+t+"'";var i=function(e,r){var i=null,l=[];if(r.rows.length)for(var a=0,s=r.rows.length;s>a;a++)i=JSON.parse(r.rows.item(a).value),i.key=r.rows.item(a).id,l.push(i);n.isArray(t)||(l=l.length?l[0]:null),o&&n.lambda(o).call(n,l)};return this.db.transaction(function(t){t.executeSql(r,[],i,e)}),this},exists:function(t,o){var n="SELECT * FROM "+this.name+" WHERE id = ?",r=this,i=function(e,t){o&&r.fn("exists",o).call(r,t.rows.length>0)};return this.db.transaction(function(o){o.executeSql(n,[t],i,e)}),this},all:function(t){var o=this,n="SELECT * FROM "+this.name,r=[],i=this.fn(this.name,t)||void 0,l=function(e,t){if(0!=t.rows.length)for(var n=0,l=t.rows.length;l>n;n++){var a=JSON.parse(t.rows.item(n).value);a.key=t.rows.item(n).id,r.push(a)}i&&i.call(o,r)};return this.db.transaction(function(t){t.executeSql(n,[],l,e)}),this},remove:function(t,o){var n=this,r="string"==typeof t?t:t.key,i="DELETE FROM "+this.name+" WHERE id = ?",l=function(){o&&n.lambda(o).call(n)};return this.db.transaction(function(t){t.executeSql(i,[r],l,e)}),this},nuke:function(t){var o="DELETE FROM "+this.name,n=this,r=t?function(){n.lambda(t).call(n)}:function(){};return this.db.transaction(function(t){t.executeSql(o,[],r,e)}),this}}}());