util.scoped(function(){var e={},t=document.getElementById("cwt_menu");document.getElementById("cwt_menu_header"),document.getElementById("cwt_menu_content");var o=document.getElementById("cwt_menu_entries"),n="button_active";controller.menuPosX=-1,controller.menuPosY=-1,controller.menuCursorIndex=-1,controller.resetMenuCursor=function(){controller.menuCursorIndex=0},controller.setMenuIndex=function(e){controller.playSound("MENUTICK"),o.children[controller.menuCursorIndex].className="",controller.menuCursorIndex=e,o.children[controller.menuCursorIndex].className=n},controller.increaseMenuCursor=function(){o.children[controller.menuCursorIndex].className="",controller.menuCursorIndex++,controller.menuCursorIndex===controller.stateMachine.data.menu.size?controller.menuCursorIndex--:controller.playSound("MENUTICK"),o.children[controller.menuCursorIndex].className=n,o.children[controller.menuCursorIndex].children[0].focus()},controller.decreaseMenuCursor=function(){o.children[controller.menuCursorIndex].className="",controller.menuCursorIndex--,0>controller.menuCursorIndex?controller.menuCursorIndex=0:controller.playSound("MENUTICK"),o.children[controller.menuCursorIndex].className=n,o.children[controller.menuCursorIndex].children[0].focus()},controller.showMenu=function(n,r,i){constants.DEBUG&&util.log("opening GUI menu"),TILE_LENGTH*controller.screenScale;var l=e.__mainMenu__;if("ACTION_SUBMENU"===controller.stateMachine.state){var a=e[controller.stateMachine.data.action.selectedEntry];a&&(l=a)}if(1===arguments.length&&(r=controller.menuPosX,i=controller.menuPosY),!model.isValidPosition(r,i))throw Error("invalid menu position");for(var s=o.children,c=0,d=s.length;d>c;c++)s[c].style.display="none";for(var c=0,d=n.size;d>c;c++){var u;if(s.length>c)s[c].className="",u=s[c].children[0];else{u=document.createElement("button");var m=document.createElement("li");m.appendChild(u),o.appendChild(m)}l(n.data[c],u,c),s[c].style.display=""}r-=controller.screenX,i-=controller.screenY,controller.menuPosX=r,controller.menuPosY=i,controller.menuCursorIndex=0,o.children[controller.menuCursorIndex].className="activeButton",o.children[controller.menuCursorIndex].children[0].focus(),t.style.opacity=1,t.style.top="96px",controller.menuVisible=!0,controller.setMenuIndex(0)},controller.hideMenu=function(){constants.DEBUG&&util.log("closing GUI menu"),o.children[controller.menuCursorIndex].className="",t.style.opacity=0,t.style.top="-1000px",controller.menuCursorIndex=-1,controller.menuVisible=!1},controller.menuVisible=!1,controller.isMenuOpen=function(){return controller.menuVisible},controller.registerMenuRenderer=function(t,o){e.hasOwnProperty(t)&&util.raiseError("renderer for",t,"is already registered"),e[t]=o}});