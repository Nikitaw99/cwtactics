controller.actionMap={},controller.actionIdMap={},controller.actionObjects={},controller.actionBuffer_=util.createRingBuffer(constants.ACTIONS_BUFFER_SIZE),controller.defineAction_=function(t){t.hasOwnProperty("condition")||(t.condition=null),t.hasOwnProperty("key")||model.criticalError(constants.error.ILLEGAL_PARAMETERS,constants.error.ACTION_KEY_MISSING),t.hasOwnProperty("invoke")||model.criticalError(constants.error.ILLEGAL_PARAMETERS,constants.error.ACTION_IMPLEMENTATION_MISSING),controller.actionObjects.hasOwnProperty(t.key)&&model.criticalError(constants.error.ILLEGAL_PARAMETERS,constants.error.ACTION_KEY_ALREADY_DEFINED),t.hasOwnProperty("prepareMenu")||(t.prepareMenu=null),t.hasOwnProperty("prepareTargets")||(t.prepareTargets=null),t.hasOwnProperty("prepareSelection")||(t.prepareSelection=null),t.hasOwnProperty("isTargetValid")||(t.isTargetValid=null),t.hasOwnProperty("multiStepAction")||(t.multiStepAction=!1),null===t.prepareTargets||t.hasOwnProperty("targetSelectionType")||(t.targetSelectionType="A"),null!==t.prepareTargets&&null!==t.isTargetValid&&model.criticalError(constants.error.ILLEGAL_PARAMETERS,constants.error.ACTION_ONLY_ONE_SELECTION_TYPE),controller.actionObjects[t.key]=t},controller.unitAction=function(t){t.mapAction=!1,t.clientAction=!1,t.unitAction=!0,t.propertyAction=!1,controller.defineAction_(t)},controller.propertyAction=function(t){t.mapAction=!1,t.clientAction=!1,t.unitAction=!1,t.propertyAction=!0,controller.defineAction_(t)},controller.mapAction=function(t){t.mapAction=!0,t.clientAction=!1,t.unitAction=!1,t.propertyAction=!1,controller.defineAction_(t)},controller.clientAction=function(t){t.mapAction=!1,t.clientAction=!0,t.unitAction=!1,t.propertyAction=!1,controller.defineAction_(t)},controller.getInvokementArguments=function(t,e){for(var n=[],r=0,o=e.length;o>r;r++)n[r]=e[r];return n[n.length]=controller.actionIdMap[t],n},controller.localInvokement=function(t,e){(2===arguments.length&&!controller.actionIdMap[t]||1===arguments.length&&!controller.actionMap[t[t.length-1]])&&model.criticalError(constants.error.ILLEGAL_DATA,constants.error.NON_ACTION_CALL_FUNCTION),2===arguments.length&&(t=controller.getInvokementArguments(t,e)),constants.DEBUG&&util.log("adding",JSON.stringify(t),"to the command stack as",controller.actionMap[this.__actionId__],"command"),controller.actionBuffer_.push(t)},controller.sharedInvokement=function(t,e){(2===arguments.length&&!controller.actionIdMap[t]||1===arguments.length&&!controller.actionMap[t[t.length-1]])&&model.criticalError(constants.error.ILLEGAL_DATA,constants.error.NON_ACTION_CALL_FUNCTION),2===arguments.length&&(t=controller.getInvokementArguments(t,e)),controller.isNetworkGame()&&controller.sendNetworkMessage(JSON.stringify(t)),controller.localInvokement(t)},util.scoped(function(){var t=0;controller.registerInvokableCommand=function(e){util.expectFunction(model,e,!0)||model.criticalError(constants.error.ILLEGAL_DATA,constants.error.NON_MODEL_FUNCTION),controller.actionMap[""+t]=e,controller.actionIdMap[e]=""+t,t++}});